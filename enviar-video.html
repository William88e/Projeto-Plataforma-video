<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8" />
    <title>Wílldeos</title>
    <link rel="stylesheet" href="css/estilo.css" />
    <style>
      input[type="file"] {
        display: flex;
        margin: 10px;
        padding: 40px;
        font-size: 40px;
        background: darkgray;
        border-radius: 20px;
      }
    </style>
  </head>
  <a href="index.html">voltar</a> <br>
  <body class="conteudo exercicio" style="align-items: center;">
    <input id="video" type="file" name="arquivo" />
    <div class="progresso"></div>

    <script>
      function ajaxUpload(config) {
        const xhr = new XMLHttpRequest();
        if (xhr.upload) {
          xhr.upload.onprogress = e => {
            // onprogress--Monitora o processo do upload-->
            const atual = e.loaded; // inicio
            const total = e.total; // fim
            const percentual = Math.floor(atual / total * 100);
            config.progresso({ atual, total, percentual });
            //envia para a div progresso a ação
          };
        }
        xhr.open("post", config.url, true);
        xhr.send(config.formData);
      }
      document.querySelector("input[type=file]").onchange = e => {
        const formData = new FormData();
        const inputFile = e.target;
        formData.append(inputFile.name, inputFile.files[0]);
        ajaxUpload({
          url: "upload",
          formData: formData,
          progresso(dados) {
            const progresso = document.querySelector(".progresso");
            progresso.innerHTML = JSON.stringify(dados);
          }
        });
      };
    </script>
  </body>
</html>
